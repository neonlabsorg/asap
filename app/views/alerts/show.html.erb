
<div id="<%= dom_id(@alert) %>">
  <%= turbo_frame_tag :main, data: { turbo_action: 'advance' } do %>

<!-- This is an example component -->
<div class='flex items-center justify-center min-h-screen'>  <div class="rounded-xl border p-5 shadow-md w-9/12 bg-white">
    <div class="flex w-full items-center justify-between border-b pb-3">
      <div class="flex items-center space-x-3">
      <i class="h-4 w-4 rounded-full fa-solid fa-feather"></i>
        <div class="text-lg font-bold text-slate-700">Alert details</div>
      </div>
      <div class="flex items-center space-x-8">
        <%= link_to '/alerts', class: "text-lg text-neutral-800" do %>
        <i class="fa-regular fa-circle-xmark"></i>
        <% end %>
      </div>
    </div>

    <div class="mt-4 mb-6">
      <div class="mb-3 text-xl font-bold break-all"><%= @alert.title %></div>
      <% if @alert.output.present? %>
        <div class="bg-gray-50 rounded-lg shadow-inner p-4">
          <div class="text-sm text-neutral-600">
            <% begin %>
              <div class="overflow-x-auto whitespace-nowrap">
                <%= @alert.output.gsub("\r\n", "\n").gsub(/(\s*\n){3,}/, "\n\n").gsub("\n", "<br>").gsub(" ", "&nbsp;").html_safe %>
              </div>
            <% rescue %>
              <%= @alert.output %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>


<div class="mt-4 mb-6">
  <div class="flex flex-col space-y-2">

    <div class="flex flex-wrap items-start text-sm font-bold">
      <div class="w-full sm:w-1/4">Asset</div>
      <div class="w-full sm:w-3/4 text-neutral-600 break-all"><%= @alert.asset %></div>
    </div>

    <div class="flex flex-wrap items-start text-sm font-bold">
      <div class="w-full sm:w-1/4">Remediation</div>
      <div class="w-full sm:w-3/4 text-neutral-600 break-all"><%= @alert.remediation %></div>
    </div>

    <div class="flex flex-wrap items-start text-sm font-bold">
      <div class="w-full sm:w-1/4">Source</div>
      <div class="text-neutral-600 break-all flex-1"><%= @alert.source %></div>
    </div>

    <div class="flex flex-wrap items-start text-sm font-bold">
      <div class="w-full sm:w-1/4">Severity</div>
      <div class="w-full sm:w-3/4 text-neutral-600 break-all"><%= @alert.severity %></div>
    </div>

    <div class="flex flex-wrap items-start text-sm font-bold">
      <div class="w-full sm:w-1/4">Issue</div>
      <div class="w-full sm:w-3/4 text-neutral-600"><%= @alert.issue.to_s.gsub(/\[.*?\]/,'') %></div>
    </div>
    
    <div class="flex flex-wrap items-start text-sm font-bold">
      <div class="w-full sm:w-1/4">CVE list</div>
      <div class="w-full sm:w-3/4 text-neutral-600"><%= @alert.cve_list.join(', ') %></div>
    </div>

    <div class="flex flex-wrap items-start text-sm font-bold">
      <div class="w-full sm:w-1/4">DC/Network</div>
      <div class="w-full sm:w-3/4 text-neutral-600"><%= @alert.dc %></div>
    </div>

    <div class="flex flex-wrap items-start text-sm font-bold">
      <div class="w-full sm:w-1/4">Vulnerability details</div>
      <div class="w-full sm:w-3/4 text-neutral-600"><%= @alert.nessus_plugin_id %></div>
    </div>

    <div class="flex flex-wrap items-start text-sm font-bold">
      <div class="w-full sm:w-1/4">Created at</div>
      <div class="w-full sm:w-3/4 text-neutral-600"><%= @alert.created_at %></div>
    </div>

    <div class="flex flex-wrap items-start text-sm font-bold">
      <div class="w-full sm:w-1/4">Last detected at</div>
      <div class="w-full sm:w-3/4 text-neutral-600"><%= @alert.last_detected_at %></div>
    </div>

    <div class="flex flex-wrap items-start text-sm font-bold">
      <div class="w-full sm:w-1/4">Last closed at</div>
      <div class="w-full sm:w-3/4 text-neutral-600"><%= @alert.last_closed_at %></div>
    </div>

    <div class="flex flex-wrap items-start text-sm font-bold">
      <div class="w-full sm:w-1/4">Last closed by</div>
      <div class="w-full sm:w-3/4 text-neutral-600"><%= @alert.last_closed_by %></div>
    </div>

    <div class="flex flex-wrap items-start text-sm font-bold">
      <div class="w-full sm:w-1/4">Active</div>
      <div class="w-full sm:w-3/4 text-neutral-600"><%= @alert.active %></div>
    </div>

  </div>
</div>

    <%# <div>
      <div class="flex items-center justify-between text-slate-500">
        <div class="flex space-x-4 md:space-x-8">
          <div class="flex cursor-pointer items-center transition hover:text-slate-600">
            <svg xmlns="http://www.w3.org/2000/svg" class="mr-1.5 h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" />
            </svg>
            <span>125</span>
          </div>
        </div>
      </div>
    </div> %>
  </div>
</div>


<% end %>
</div>